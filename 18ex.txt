#include <iostream>
#include <ctime>
using namespace std;

void play(string colorO, string colorX, int move, int size_area) {
    srand(time(NULL));
    const int SIZE = 3;
    string game[SIZE][SIZE];

    if (size_area == 2)
    {
        const int SIZE = 4;
        char game[SIZE][SIZE];
    }
    else if (size_area == 3)
    {
        const int SIZE = 5;
        char game[SIZE][SIZE];
    }
    //values for array game
    for (int i = 0; i < SIZE; i++)
    {
        for (int j = 0; j < SIZE; j++) {
            game[i][j] = "_";
        }
    }

    int count = 0;
    string winner = "*";
    string player = colorX + "X";
    while (count != 9)
    {
        count++;
        if (player == (colorX + "X"))
        {
            int col = 0, row = 0;
            while (true)
            {
                //print game
                for (int i = 0; i < SIZE; i++)
                {
                    for (int j = 0; j < SIZE; j++) {
                        cout << game[i][j] << "|";
                    }
                    cout << endl;
                }
                cout << "__________________" << endl;
                cout << "Step X" << endl;
                cout << "__________________" << endl;
                int n = 1;
                for (int i = 0; i < SIZE; i++)
                {
                    for (int j = 0; j < SIZE; j++) {
                        cout << n + j << "|";
                    }
                    n += 3;
                    cout << endl;
                }
                int posotion;
                cout << "Select option: ";
                cin >> posotion;
                switch (posotion)
                {
                case 1: row = 0; col = 0; break;
                case 2: row = 0; col = 1; break;
                case 3: row = 0; col = 2; break;
                case 4: row = 1; col = 0; break;
                case 5: row = 1; col = 1; break;
                case 6: row = 1; col = 2; break;
                case 7: row = 2; col = 0; break;
                case 8: row = 2; col = 1; break;
                case 9: row = 2; col = 2; break;
                }
                if (posotion > 0 && posotion < 10 && game[row][col] == "_") { break; }
                else { cout << "Error!!! Select true option!!!!" << endl; }
            }
            game[row][col] = player;
            player = (colorO+"0");
        }
        else if (player == (colorO + "0"))
        {
            int col = 0, row = 0;
            while (true)
            {
                int posotion = 1 + rand() % 9;
                switch (posotion)
                {
                case 1: row = 0; col = 0; break;
                case 2: row = 0; col = 1; break;
                case 3: row = 0; col = 2; break;
                case 4: row = 1; col = 0; break;
                case 5: row = 1; col = 1; break;
                case 6: row = 1; col = 2; break;
                case 7: row = 2; col = 0; break;
                case 8: row = 2; col = 1; break;
                case 9: row = 2; col = 2; break;
                }
                if (game[row][col] == "_") { break; }
            }
            if (game[0][0] == "_" && (game[0][1] == colorX+"X" && game[0][2] == colorX + "X" || game[1][1] == colorX + "X" && game[2][2] == colorX + "X" || game[1][0] == colorX + "X" && game[2][0] == colorX + "X")) {
                row = 0; col = 0;
            }
            else if (game[0][1] == "_" && (game[0][0] == colorX + "X" && game[0][2] == colorX + "X" || game[1][1] == colorX + "X" && game[2][1] == colorX + "X")) {
                row = 0; col = 1;
            }
            game[row][col] = player;
            player = colorX+"X";
        }

        if (game[0][0] != "_" && (game[0][0] == game[0][1] && game[0][1] == game[0][2] || game[0][0] == game[1][0] && game[1][0] == game[2][0] || game[0][0] == game[1][1] && game[1][1] == game[2][2])) {
            winner = game[0][0];
        }
        else if (game[0][1] != "_" && game[0][1] == game[1][1] && game[1][1] == game[2][1]) {
            winner = game[0][1];
        }
        else if (game[0][2] != "_" && (game[0][2] == game[1][2] && game[1][2] == game[2][2] || game[0][2] == game[1][1] && game[1][1] == game[2][0])) {
            winner = game[0][2];
        }
        else if (game[1][0] != "_" && game[1][0] == game[1][1] && game[1][1] == game[1][2]) {
            winner = game[1][0];
        }
        else if (game[2][0] != "_" && game[2][0] == game[2][1] && game[2][1] == game[2][2]) {
            winner = game[2][0];
        }

        if (winner != "*") {
            break;
        }
    }
    cout << "__________________" << endl;
    cout << "END GAME" << endl;
    cout << "__________________" << endl;
    if (winner == "*") {
        cout << "Draw!!!" << endl;
    }
    else {
        cout << winner << "'s win!" << endl;
    }
}


int main()
{
    setlocale(0, "");
    cout << "Меню\n1. Начать игру\n2. Настройки\n3. Правила\n4. Выйти\n";
    int choose;
    string colorO;
    string colorX;
    int move;
    int size_area;
    cin >> choose;
    switch (choose)
    {
    case 1: {
        play(colorO, colorX, move, size_area);
        break;
    }
    case 2: {
        int stop = 0;
        while (stop != 4)
        {
            system("cls");
            cout << "Настройки\n1. Цвет крестика и нолика\n2. Кто первый ходит\n3. Размер поля\n4.Выход\n";
            cin >> choose;
            while (choose < 1 || choose>4)
            {
                cin >> choose;
            }
            switch (choose)
            {
            case 1: {
                cout << "Цвета:\n1)стандарт\n2)светло-серый\n3)серый\n4)красный\n5)зеленый\n6)желтый\n7)синий\n8)фиолетовый\n9)голубой\n10)белый\n";
                cout << "Цвет крестика: ";
                int choose;
                cin >> choose;
                while (choose < 1 || choose>10)
                {
                    cin >> choose;
                }

                switch (choose)
                {
                case 1: colorX = "\x1b[0m"; break;
                case 2: colorX = "\x1b[89m"; break;
                case 3: colorX = "\x1b[90m"; break;
                case 4: colorX = "\x1b[91m"; break;
                case 5: colorX = "\x1b[92m"; break;
                case 6: colorX = "\x1b[93m"; break;
                case 7: colorX = "\x1b[94m"; break;
                case 8: colorX = "\x1b[95m"; break;
                case 9: colorX = "\x1b[96m"; break;
                case 10: colorX = "\x1b[97m"; break;
                default:
                    break;
                }
                cout << "Цвет нолика: ";
                cin >> choose;
                while (choose < 1 || choose>10)
                {
                    cin >> choose;
                }
                switch (choose)
                {
                case 1: colorO = "\x1b[0m"; break;
                case 2: colorO = "\x1b[89m"; break;
                case 3: colorO = "\x1b[90m"; break;
                case 4: colorO = "\x1b[91m"; break;
                case 5: colorO = "\x1b[92m"; break;
                case 6: colorO = "\x1b[93m"; break;
                case 7: colorO = "\x1b[94m"; break;
                case 8: colorO = "\x1b[95m"; break;
                case 9: colorO = "\x1b[96m"; break;
                case 10: colorO = "\x1b[97m"; break;
                default:
                    break;
                }
                break;
            }
            case 2: {
                cout << "Кто первый ходит: 1)X 2)O\n";
                cin >> move;
                while (move < 1 || move>2)
                {
                    cin >> move;
                }
                break;
            }
            case 3: {
                cout << "1)3x3 2)4x4 3)5x5\n";
                cin >> size_area;
                while (size_area < 1 || size_area>3)
                {
                    cin >> size_area;
                }
                break;
            }
            case 4: {
                stop = 4;
                break;
            }
            default:
                break;
            }
        }
        system("cls");
        main();
        break;
    }
    case 3: {
        cout << "Игроки по очереди ставят на свободные клетки поля 3x3 знаки (один всегда крестики, другой всегда нолики). Первый, выстроивший в ряд 3 своих фигуры по вертикали, горизонтали или диагонали, выигрывает. Первый ход делает игрок, ставящий крестики. Обычно по завершении партии выигравшая сторона зачёркивает чертой свои три знака(нолика или крестика), составляющих сплошной ряд.\n\n";
        cout << "Для выхода нажмите 1\n";
        int esc;
        cin >> esc;
        while (esc != 1)
        {
            cin >> esc;
        }
        system("cls");
        main();
        break;
    }
    case 4: {
        break;
    }
    default:
        system("cls");
        main();
        break;
    }
    return 0;
}