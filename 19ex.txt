#include <iostream>
#include <ctime>
#include <chrono>
using namespace std;
using namespace chrono;

string random_question(string choose[]) {
	int random;
	string answers;
	int check_arr[4]{100,100,100,100};
	bool check = true;
	int n = 0;
	while (n<4)
	{
		random = 1 + rand() % 4;
		for (int i = 0; i < 4 && check; i++)
		{
			if (check_arr[i]==random)
			{
				random = 1 + rand() % 4;
				i = 0;
				check = false;
			}
		}
		check = true;
		for (int i = 0; i < 4 && check; i++)
		{
			if (check_arr[i] == 100)
			{
				check_arr[i] = random;
				check = false;
			}
		}
		answers += choose[random];
		n++;
	}
	return answers;
}

void play(int hp, int question, int time_play) {
	srand(time(NULL));
	system("cls");

	int end = question;
	int random;
	int answer;
	const int arr_question = 4;

	const int size = 15;
	int arr[size]{};

	int n = 0;
	bool check = true;
	if (question == 5)
	{
		n = 10;
	}
	else if (question == 10)
	{
		n = 5;
	}
	steady_clock::time_point tend = steady_clock::now() + minutes(time_play);
	while (steady_clock::now() < tend && hp > 0 && end > 0)
	{
		random = 1 + rand() % question;
		for (int i = 0; i < size - n && check; i++)
		{
			if (arr[i] == random)
			{
				random = 1 + rand() % question;
				i = 0;
				check = false;
			}
		}
		check = true;
		for (int i = 0; i < size - n && check; i++)
		{
			if (arr[i] == 0)
			{
				arr[i] = random;
				check = false;
			}
		}

		switch (random)
		{
		case 1: {
			cout << "Размер типа данных int:";
			string choose[arr_question]{"1)1 байт ", "2)байт ", "3)байт ", "4)байт "};
			cout<< random_question(choose);
			cin >> answer;
			if (answer == 2) {
				break;
			}
			else {
				hp--;
				break;
			}
		}
		default:
			break;
		}
		end--;
	}
}


int set_hp() {
	cout << "Введите кол-во жизней от 1 до 5: ";
	int hp = 0;
	while (hp < 1 || hp>5)
	{
		cin >> hp;
	}
	return hp;
}

int set_question() {
	cout << "Введите кол-во вопросов(5,10,15): ";
	int question = 0;
	while (question != 5 && question != 10 && question != 15)
	{
		cin >> question;
	}
	return question;
}

int set_time() {
	cout << "Введите время игры(1,2,3): ";
	int time = 0;
	while (time != 1 && time != 2 && time != 3)
	{
		cin >> time;
	}
	return time;
}

int main()
{
	setlocale(0, "");
	bool game = true;
	int hp = 3;
	int question = 5;
	int time_play = 2;
	while (game)
	{
		cout << "Меню\n1.Начать викторину\n2.Настройки\n3.Выход\n";
		int choose;
		cin >> choose;
		switch (choose)
		{
		case 1: {
			play(hp, question, time_play);
			game = false;
			break;
		}
		case 2: {
			int stop = 0;
			while (stop != 4)
			{
				system("cls");
				cout << "1.Кол-во жизней\n2.Время(в минутах)\n3.Кол-во вопросов\n4.Выход\n";
				cin >> choose;
				switch (choose)
				{
				case 1: {
					hp = set_hp();
					break;
				}
				case 2: {
					time_play = set_time();
					break;
				}
				case 3: {
					question = set_question();
					break;
				}
				case 4: {
					stop = 4;
					break;
				}
				default:
					break;
				}
			}
			system("cls");
			break;
		}
		case 3: {
			system("cls");
			game = false;
			break;
		}
		default:
			system("cls");
			break;
		}
	}
}
